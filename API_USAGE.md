# Sales Scout - API –¥–ª—è –ø—Ä—è–º–æ–≥–æ –≤—ã–∑–æ–≤–∞

## –ù–æ–≤—ã–π endpoint –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –∫–æ–º–ø–∞–Ω–∏–π

### URL

```
POST http://aistudy.dev.o2it.ru:8100/api/research
```

### –§–æ—Ä–º–∞—Ç –∑–∞–ø—Ä–æ—Å–∞

**Content-Type:** `application/json`

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (JSON):**

```json
{
    "company_name": "–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏",
    "inn": "–ò–ù–ù (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)",
    "user_id": "ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë–∏—Ç—Ä–∏–∫—Å24"
}
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|--------------|----------|
| `company_name` | string | –ù–µ—Ç* | –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä: "–Ø–Ω–¥–µ–∫—Å", "–û–û–û –†–æ–≥–∞ –∏ –ö–æ–ø—ã—Ç–∞") |
| `inn` | string | –ù–µ—Ç* | –ò–ù–ù –∫–æ–º–ø–∞–Ω–∏–∏ (10 –∏–ª–∏ 12 —Ü–∏—Ñ—Ä) |
| `user_id` | string | **–î–∞** | ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë–∏—Ç—Ä–∏–∫—Å24 –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ |

*–î–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–∫–∞–∑–∞–Ω —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω: `company_name` –ò–õ–ò `inn`

### –û—Ç–≤–µ—Ç API

**Success (–∑–∞–ø—Ä–æ—Å –ø—Ä–∏–Ω—è—Ç):**

```json
{
    "status": "processing",
    "message": "–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ '–Ø–Ω–¥–µ–∫—Å' –∑–∞–ø—É—â–µ–Ω–æ. –†–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é 10"
}
```

**Error (–æ—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏):**

```json
{
    "status": "error",
    "message": "–£–∫–∞–∂–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ (company_name) –∏–ª–∏ –ò–ù–ù (inn)"
}
```

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–ü—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–ø—Ä–æ—Å** - API –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç—É—Å "processing"
2. **–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤ —Ñ–æ–Ω–µ** - —Å–æ–±–∏—Ä–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é (1-3 –º–∏–Ω—É—Ç—ã)
3. **–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤ –ë–∏—Ç—Ä–∏–∫—Å24 –ø—Ä–∏—Ö–æ–¥–∏—Ç:
   - –ü–æ–ª–Ω–æ–µ –¥–æ—Å—å–µ –∫–æ–º–ø–∞–Ω–∏–∏
   - –ö–Ω–æ–ø–∫–∏ –æ—Ü–µ–Ω–∫–∏

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ü–æ–∏—Å–∫ –ø–æ –ò–ù–ù

```bash
curl -X POST http://aistudy.dev.o2it.ru:8100/api/research \
  -H "Content-Type: application/json" \
  -d '{
    "inn": "7707083893",
    "user_id": "10"
  }'
```

**–û—Ç–≤–µ—Ç:**
```json
{
    "status": "processing",
    "message": "–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ '7707083893' –∑–∞–ø—É—â–µ–Ω–æ. –†–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é 10"
}
```

### –ü—Ä–∏–º–µ—Ä 2: –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é

```bash
curl -X POST http://aistudy.dev.o2it.ru:8100/api/research \
  -H "Content-Type: application/json" \
  -d '{
    "company_name": "–Ø–Ω–¥–µ–∫—Å",
    "user_id": "10"
  }'
```

### –ü—Ä–∏–º–µ—Ä 3: –ù–∞–∑–≤–∞–Ω–∏–µ + –ò–ù–ù (–¥–ª—è —Ç–æ—á–Ω–æ—Å—Ç–∏)

```bash
curl -X POST http://aistudy.dev.o2it.ru:8100/api/research \
  -H "Content-Type: application/json" \
  -d '{
    "company_name": "–Ø–Ω–¥–µ–∫—Å",
    "inn": "7707083893",
    "user_id": "10"
  }'
```

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–∑ –ë–∏—Ç—Ä–∏–∫—Å24

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò–∑ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤

1. **Webhook –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å** –≤ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–µ
2. **URL:** `http://aistudy.dev.o2it.ru:8100/api/research`
3. **–ú–µ—Ç–æ–¥:** POST
4. **–ó–∞–≥–æ–ª–æ–≤–∫–∏:** `Content-Type: application/json`
5. **–¢–µ–ª–æ:**

```
{
    "company_name": "{{=Document:TITLE}}",
    "inn": "{{=Document:UF_CRM_XXXXX}}",
    "user_id": "{{=Document:ASSIGNED_BY_ID}}"
}
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò–∑ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ (—Ä–æ–±–æ—Ç—ã)

**–†–æ–±–æ—Ç "Webhook":**
- **URL:** `http://aistudy.dev.o2it.ru:8100/api/research`
- **–ú–µ—Ç–æ–¥:** POST
- **–î–∞–Ω–Ω—ã–µ:**

```json
{
    "company_name": "{=Document:TITLE}",
    "inn": "{=Document:UF_CRM_INN}",
    "user_id": "{=Document:ASSIGNED_BY_ID}"
}
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ò–∑ REST API (–∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)

```php
<?php
// –í –≤–∞—à–µ–º –ë–∏—Ç—Ä–∏–∫—Å24 –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

$url = 'http://aistudy.dev.o2it.ru:8100/api/research';

$data = [
    'company_name' => '–Ø–Ω–¥–µ–∫—Å',
    'inn' => '7707083893',
    'user_id' => '10'
];

$ch = curl_init($url);
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($data));
curl_setopt($ch, CURLOPT_HTTPHEADER, ['Content-Type: application/json']);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);

$response = curl_exec($ch);
curl_close($ch);

$result = json_decode($response, true);
echo $result['message'];
?>
```

### –í–∞—Ä–∏–∞–Ω—Ç 4: –ò–∑ JavaScript (–∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–¥)

```javascript
// –í –≤–∞—à–µ–º –ë–∏—Ç—Ä–∏–∫—Å24 –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

BX24.init(function() {
    fetch('http://aistudy.dev.o2it.ru:8100/api/research', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            company_name: '–Ø–Ω–¥–µ–∫—Å',
            inn: '7707083893',
            user_id: BX24.placement.info().userId
        })
    })
    .then(response => response.json())
    .then(data => {
        console.log(data.message);
        BX24.fitWindow();
    });
});
```

---

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CRM —Å–¥–µ–ª–∫–∞–º–∏

### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–¥–µ–ª–∫–∏

**–¢—Ä–∏–≥–≥–µ—Ä:** –°–¥–µ–ª–∫–∞ —Å–æ–∑–¥–∞–Ω–∞

**–î–µ–π—Å—Ç–≤–∏–µ:** Webhook

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏:**
- URL: `http://aistudy.dev.o2it.ru:8100/api/research`
- –ú–µ—Ç–æ–¥: POST
- –¢–µ–ª–æ:

```json
{
    "company_name": "{=Document:COMPANY_TITLE}",
    "inn": "{=Document:UF_CRM_INN}",
    "user_id": "{=Document:ASSIGNED_BY_ID}"
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–æ —Å–¥–µ–ª–∫–µ –ø–æ–ª—É—á–∏—Ç –¥–æ—Å—å–µ –∫–æ–º–ø–∞–Ω–∏–∏ –≤ —á–∞—Ç–µ

---

## –ü—Ä–∏–º–µ—Ä—ã curl –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –¢–µ—Å—Ç —Å –Ø–Ω–¥–µ–∫—Å–æ–º

```bash
curl -X POST http://aistudy.dev.o2it.ru:8100/api/research \
  -H "Content-Type: application/json" \
  -d '{
    "company_name": "–Ø–Ω–¥–µ–∫—Å",
    "user_id": "10"
  }'
```

### –¢–µ—Å—Ç —Å –ò–ù–ù –°–±–µ—Ä–±–∞–Ω–∫–∞

```bash
curl -X POST http://aistudy.dev.o2it.ru:8100/api/research \
  -H "Content-Type: application/json" \
  -d '{
    "inn": "7736207543",
    "user_id": "10"
  }'
```

### –¢–µ—Å—Ç —Å Idol face

```bash
curl -X POST http://aistudy.dev.o2it.ru:8100/api/research \
  -H "Content-Type: application/json" \
  -d '{
    "company_name": "Idol face",
    "user_id": "10"
  }'
```

---

## –ü–æ–ª—É—á–µ–Ω–∏–µ user_id –≤ –ë–∏—Ç—Ä–∏–∫—Å24

### –ò–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–∞:

- `{{=Document:ASSIGNED_BY_ID}}` - –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π
- `{{=Document:CREATED_BY}}` - —Å–æ–∑–¥–∞—Ç–µ–ª—å
- `{{=CurrentUser:ID}}` - —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

### –ò–∑ JavaScript API:

```javascript
BX24.placement.info().userId
```

### –ò–∑ PHP:

```php
global $USER;
$userId = $USER->GetID();
```

---

## –ê–≤—Ç–æ–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:

```
http://aistudy.dev.o2it.ru:8100/docs
```

–í—ã —É–≤–∏–¥–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é Swagger —Å–æ –≤—Å–µ–º–∏ endpoints –∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏.

---

## –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä: –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–æ–Ω—Ç–∞–∫—Ç–∞

**–°—Ü–µ–Ω–∞—Ä–∏–π:** –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–æ–Ω—Ç–∞–∫—Ç–∞ —Å –∫–æ–º–ø–∞–Ω–∏–µ–π - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±—Ä–∞—Ç—å –¥–æ—Å—å–µ

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ –ë–∏—Ç—Ä–∏–∫—Å24:**

1. –û—Ç–∫—Ä–æ–π—Ç–µ: CRM ‚Üí –ö–æ–Ω—Ç–∞–∫—Ç—ã ‚Üí –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
2. –î–æ–±–∞–≤—å—Ç–µ —Ä–æ–±–æ—Ç–∞ "Webhook"
3. **–ù–∞—Å—Ç—Ä–æ–π–∫–∏:**
   - URL: `http://aistudy.dev.o2it.ru:8100/api/research`
   - –ú–µ—Ç–æ–¥: POST
   - –î–∞–Ω–Ω—ã–µ:

```json
{
    "company_name": "{=Contact:COMPANY_TITLE}",
    "inn": "{=Contact:UF_CRM_INN}",
    "user_id": "{=Contact:ASSIGNED_BY_ID}"
}
```

4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–æ–Ω—Ç–∞–∫—Ç–∞ - –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—å–µ –∫–æ–º–ø–∞–Ω–∏–∏ –≤ —á–∞—Ç!

---

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ endpoint —Ä–∞–±–æ—Ç–∞–µ—Ç

```bash
curl http://aistudy.dev.o2it.ru:8100/health
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

```bash
ssh myserver tail -f /opt/sales-scout/sales_scout.log | grep "API research"
```

---

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```bash
curl http://aistudy.dev.o2it.ru:8100/stats
```

---

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- **–û–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è ~1-3 –º–∏–Ω—É—Ç—ã
- **–ù–µ—Ç –æ—á–µ—Ä–µ–¥–∏** - –µ—Å–ª–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å 10 –∑–∞–ø—Ä–æ—Å–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ, –≤—Å–µ –æ–±—Ä–∞–±–æ—Ç–∞—é—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
- **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ª–∏–º–∏—Ç:** 50-100 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —á–∞—Å

---

## Troubleshooting

### –û—à–∏–±–∫–∞ "user_id not found"

–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤ –∑–∞–ø—Ä–æ—Å–µ –ø–µ—Ä–µ–¥–∞–Ω –≤–∞–ª–∏–¥–Ω—ã–π user_id –∏–∑ –ë–∏—Ç—Ä–∏–∫—Å24.

### –î–æ–ª–≥–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (>5 –º–∏–Ω—É—Ç)

- Perplexity –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –º–µ–¥–ª–µ–Ω–Ω–æ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `ssh myserver tail -f /opt/sales-scout/sales_scout.log`
- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å –µ—Å–ª–∏ –∑–∞–≤–∏—Å

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç

- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ user_id –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –±–æ—Ç–∞ –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏

---

**–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üöÄ

URL: `http://aistudy.dev.o2it.ru:8100/api/research`
